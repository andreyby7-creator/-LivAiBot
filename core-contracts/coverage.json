
 RUN  v4.0.16 /home/boss/Projects/livai/core-contracts
      Coverage enabled with v8

stdout | tests/unit/errors/services/ai-service/policies/apiCircuitBreakerPolicy.test.ts > CircuitBreakerPolicy > recordSuccess/recordFailure > должен использовать logger fallback при отсутствии переданного logger
Circuit breaker transition { serviceId: 'service-11', from: 'closed', to: 'closed' }

stdout | tests/unit/errors/services/ai-service/policies/apiCircuitBreakerPolicy.test.ts > CircuitBreakerPolicy > Edge cases > должен блокировать запросы при превышении maxTestRequests в HALF_OPEN
Before: {
  shouldAllow: true,
  state: 'half_open',
  failureCount: 2,
  successCount: 0,
  testRequestCount: 0,
  lastTrigger: 'recovery_timeout'
}
Result1: {
  shouldAllow: true,
  state: 'half_open',
  failureCount: 2,
  successCount: 0,
  testRequestCount: 1,
  lastTrigger: 'recovery_timeout'
}

 ✓ tests/unit/errors/services/ai-service/policies/apiCircuitBreakerPolicy.test.ts (28 tests) 46ms

 Test Files  1 passed (1)
      Tests  28 passed (28)
   Start at  21:44:02
   Duration  514ms (transform 171ms, setup 109ms, import 101ms, tests 46ms, environment 0ms)

